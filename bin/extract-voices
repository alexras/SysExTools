#!/usr/bin/env python3

import argparse
import json

from sysextools import parse, dump


def extract_voices(sysex_file):

    voices = parse('test.syx')
    # FIXME remove this test dump command
    dump(voices, 'test_output.syx')

    for voice in voices:
        dump(voice, f"{voice['signature'].syx}")
        with open(f"{voice['signature']}.json", 'w+') as fp:
            json.dump(voice, fp, indent=2)


def main():
    parser = argparse.ArgumentParser(description='extract individual voices from a SysEx file')
    parser.add_argument('sysex_file')

    args = parser.parse_args()

    extract_voices(**vars(args))


if __name__ == '__main__':
    main()
